<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="UTF-8"><title>Responsive image</title><link rel="icon" type="image/png" sizes="64x64" href="assets/img/favicon.a55b042b-64w.png"><link href="assets/css/main.dfbc03b6.css" rel="stylesheet"></head><body><div class="main-header"><div class="header-container"><div class="header-content"><h1 class="text">Responsive image</h1></div><img srcset="assets/img/abstract.c0524103-480w.png 480w,assets/img/abstract.3fead7a9-640w.png 640w,assets/img/abstract.0f0137bf-800w.png 800w,assets/img/abstract.bf1ac12c-1024w.png 1024w,assets/img/abstract.e16308e9-1450w.png 1450w,assets/img/abstract.488539fd-1920w.png 1920w" src="assets/img/abstract.7fa56b36-1920w.webp" alt="responsive image"></div></div><main class="main-content"><section><h1>How to use responsive images with Pug</h1><p>For responsive images is recommended to use the <a href="https://github.com/dazuaz/responsive-loader">responsive-loader</a>.
This is a very fast, high-quality and powerful module.
</p><h3>Setup</h3><p>Firstly, install and configure the <a href="https://github.com/webdiscus/pug-plugin#install">pug-plugin</a>,
then install modules:</p><pre class="language-"><code>npm install responsive-loader sharp --save-dev
</code></pre><p>Add to Webpack module rules the following configuration:</p><pre class="language-"><code><span class="token punctuation">{</span>
  <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(gif|png|jpe?g|svg|webp)$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'asset/resource'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'responsive-loader'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// output filename of images</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'assets/img/[name].[hash:8]-[width]w.[ext]'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><b>Note:</b><ul><li>the type must be defined as <code class="language-">asset/resource</code></li><li>in responsible-loader version >= 3.0.4 the default adapter is <code class="language-">sharp</code></li><li>define in the <code class="language-">name</code> option both public path and output filename</li></ul></section><section><h3>Usage of image with fixed size</h3><p>Defaults, an image without queries will stay in its original size and format.</p><p>To resize an single image use the <code class="language-">size</code> query parameter:</p><pre class="language-"><code><span class="token tag">img<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">src</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">'./image.jpg?size=200'</span></span><span class="token punctuation">)</span></span></span>
</code></pre><p>To convert an image in other format, e.g. <code class="language-">webp</code>, use the <code class="language-">format</code> query parameter:</p><pre class="language-"><code><span class="token tag">img<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">src</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">'./image.jpg?size=200&amp;format=webp'</span></span><span class="token punctuation">)</span></span></span>
</code></pre><p>Usage of the image in SCSS as the background-image:</p><pre class="language-"><code><span class="token selector">.image </span><span class="token punctuation">{</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url">url</span><span class="token punctuation">(</span><span class="token string">'./image.jpg?size=200'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h3>Examples</h3><table class="image-preview"><tr><td><img src="assets/img/image.1e7c25d0-100w.webp" alt="fix image"></td><td><pre class="language-"><code><span class="token tag">img<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">src</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">'./image.webp?size=100'</span></span><span class="token punctuation">)</span></span></span></code></pre></td></tr><tr><td><img src="assets/img/image.c356e00b-120w.png" alt="fix image"></td><td><pre class="language-"><code><span class="token tag">img<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">src</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">'./image.webp?size=120&amp;format=png'</span></span><span class="token punctuation">)</span></span></span></code></pre></td></tr><tr><td><img src="assets/img/image.be705e13-140w.jpg" alt="fix image"></td><td><pre class="language-"><code><span class="token tag">img<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">src</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">'./image.webp?size=140&amp;format=jpg'</span></span><span class="token punctuation">)</span></span></span></code></pre></td></tr><tr><td><div class="demo-image"></div></td><td><pre class="language-"><code><span class="token comment">// scss</span>
<span class="token property"><span class="token variable">$width</span></span><span class="token punctuation">:</span> 200<span class="token punctuation">;</span>
<span class="token property"><span class="token variable">$height</span></span><span class="token punctuation">:</span> 145<span class="token punctuation">;</span>
<span class="token selector">.demo-image </span><span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token variable">#{$width}</span>px<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token variable">#{$height}</span>px<span class="token punctuation">;</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url">url</span><span class="token punctuation">(</span><span class="token string">'./image.jpg?size=#{$width}'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></td></tr></table><h3>Usage of responsive image</h3><p>For a responsive image use the <code class="language-">sizes&lbrack;&rbrack;</code> query parameter.<br>
For the readability of your code, define the image object in a JS context, like so:</p><pre class="language-"><code><span class="token punctuation">-</span>
  <span class="token tag">const</span> <span class="token plain-text">responsiveImage = {</span>
    <span class="token comment">// default image</span>
    <span class="token tag">src<span class="token punctuation">:</span></span> <span class="token tag">require<span class="token attributes"><span class="token punctuation">(</span>'./image.jpg?<span class="token attr-name">size</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token number">640</span>'</span><span class="token punctuation">)</span></span></span>,
    <span class="token comment">// responsive images</span>
    <span class="token tag">srcSet<span class="token punctuation">:</span></span> <span class="token tag">require<span class="token attributes"><span class="token punctuation">(</span>'./image.jpg?sizes[]<span class="token punctuation">=</span><span class="token attr-value"><span class="token number">480</span></span><span class="token punctuation">,</span>sizes[]<span class="token punctuation">=</span><span class="token attr-value"><span class="token number">640</span></span><span class="token punctuation">,</span>sizes[]<span class="token punctuation">=</span><span class="token attr-value"><span class="token number">800</span></span><span class="token punctuation">,</span>sizes[]<span class="token punctuation">=</span><span class="token attr-value"><span class="token number">1024</span></span><span class="token punctuation">,</span>sizes[]<span class="token punctuation">=</span><span class="token attr-value"><span class="token number">1450</span></span><span class="token punctuation">,</span>sizes[]<span class="token punctuation">=</span><span class="token attr-value"><span class="token number">1920</span>'</span><span class="token punctuation">)</span></span></span>,
  }
</code></pre><p><b>Note:</b> the <code class="language-">require('./image.jpg?sizes&lbrack;&rbrack;=480,sizes&lbrack;&rbrack;=640,...')</code>
in Pug returns directly a string with a comma-separated list of images.
</p><p>Then set the <code class="language-">srcset</code> and <code class="language-">src</code> image attributes:</p><pre class="language-"><code><span class="token tag">img<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">src</span><span class="token punctuation">=</span><span class="token attr-value">responsiveImage<span class="token punctuation">.</span>src srcset<span class="token operator">=</span>responsiveImage<span class="token punctuation">.</span>srcSet alt<span class="token operator">=</span><span class="token string">"responsive image"</span></span><span class="token punctuation">)</span></span></span>
</code></pre><p>Generated HTML of responsive image:</p><pre class="language-"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/assets/images/image.af5d288cf6d0be8269fb6785de4dca47-640w.jpg.jpg<span class="token punctuation">"</span></span>
  <span class="token attr-name">srcset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/assets/images/image.c89a9aadd767f562f8cea83cf8d31b90-480w.jpg 480w,
    /assets/images/image.af5d288cf6d0be8269fb6785de4dca47-640w.jpg 640w,
    /assets/images/image.39668d49ebd9fba351e0df395b762f30-800w.jpg 800w,
    /assets/images/image.1b62e4707c5462a41627051bc4b26d54-1024w.jpg 1024w,
    /assets/images/image.1c1d5de33673303eacdfa27b9b7b6e00-1450w.jpg 1450w,
    /assets/images/image.c62bf05c4abc346d0239e964ab096228-1920w.jpg 1920w<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

</code></pre><h3>Usage of responsive image with placeholder</h3><p>When the connection speed is low, the background is blank while loading a full size image.
In this case, we can show a very small version of the image as <code class="language-">background-image</code> before the original image is fully loaded.
The original image must be wrapped in a div container with an inline background image - placeholder.
</p><div>To generate a placeholder as inline data URL use the following query parameters:</div><ul><li><code class="language-">prop=placeholder</code> extract the placeholder from a result object (feature of pug-plugin)</li><li><code class="language-">placeholder=true</code> enable generating of the image as data URL</li><li><code class="language-">placeholderSize=100</code> the width of the placeholder image in px, default is 40px</li><li><code class="language-">emitFile=false</code> disable writing the original image file to the output directory,
because we only need the generated string of the data URL
</li></ul><p>For example we have an header with responsive image. The image has the width 100% and fixed height 300px.
</p><div>Using the object <code class="language-">responsiveImage</code> (see above) write in Pug:</div><pre class="language-"><code><span class="token tag"><span class="token attr-class">.box</span><span class="token punctuation">:</span></span> <span class="token tag">img<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">src</span><span class="token punctuation">=</span><span class="token attr-value">responsiveImage<span class="token punctuation">.</span>src srcset<span class="token operator">=</span>responsiveImage<span class="token punctuation">.</span>srcSet alt<span class="token operator">=</span><span class="token string">"responsive image"</span></span><span class="token punctuation">)</span></span></span>
</code></pre><div>SCSS:</div><pre class="language-"><code><span class="token property"><span class="token variable">$imgHeight</span></span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span> <span class="token comment">// fixed height of the image in header</span>

<span class="token selector">.box </span><span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token variable">$imgHeight</span><span class="token punctuation">;</span>
  <span class="token property">max-height</span><span class="token punctuation">:</span> <span class="token variable">$imgHeight</span><span class="token punctuation">;</span>
  <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
  <span class="token property">background-size</span><span class="token punctuation">:</span> cover<span class="token punctuation">;</span> <span class="token comment">// fit image with aspect ratio in the content box</span>

  <span class="token comment">// placeholder of responsive image as inline data URL</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url">url</span><span class="token punctuation">(</span><span class="token string">'./image.jpg?prop=placeholder&amp;placeholder=true&amp;placeholderSize=100'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// responsive image</span>
  <span class="token selector">img </span><span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">object-fit</span><span class="token punctuation">:</span> cover<span class="token punctuation">;</span> <span class="token comment">// fit image with aspect ratio in the content box</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><div>The result of the responsive image you can see in the header of this site.</div><p></p><div>Other way to set the placeholder is to use it in the style property as the <code class="language-">background-image: url(...)</code>.</div><pre class="language-"><code><span class="token operator">-</span> <span class="token keyword">const</span> placeholder <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./image.jpg?prop=placeholder&amp;emitFile=false&amp;placeholder=true&amp;placeholderSize=35'</span><span class="token punctuation">)</span>
<span class="token operator">-</span> <span class="token keyword">const</span> width <span class="token operator">=</span> <span class="token number">200</span>
<span class="token operator">-</span> <span class="token keyword">const</span> height <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./image.jpg?prop=height&amp;emitFile=false&amp;size="</span> <span class="token operator">+</span> width<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">box</span><span class="token punctuation">(</span>style<span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">background-image: url(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>placeholder<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">); width:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>width<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px; height:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>height<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px; background-size:cover;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
</code></pre><div><b>Note:</b> Don't use require() directly in the style property, the image file will not be resolved.</div><p></p><div>The generated HTML:</div><pre class="language-"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span>
     <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>data:image/jpeg;base64,...<span class="token punctuation">)</span></span><span class="token punctuation">;</span> <span class="token property">width</span><span class="token punctuation">:</span>200px<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span>110px<span class="token punctuation">;</span> <span class="token property">background-size</span><span class="token punctuation">:</span>cover<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
</code></pre><p></p><div>What you see in the browser:</div><div class="box" style="background-image: url(data:image/webp;base64,UklGRngBAABXRUJQVlA4IGwBAACwCACdASoyACMAPlEkjkWjoiEUCq1UOAUEtIAJAc7ZMA7AgzJU13sGBKelLVP/1pMCJ8yB+3jzDaiodrtFL5svobMpH3Ousx3rKA8s0CAA/vm+tjlKGC4LFebOMBf1nn0+eCcHleIS8YVshNtuUUmA6AuQWYZuIkCwGVDRarezLVdg2NQAARkTPij+rh0yzfZMQGX92B6H5l/m+/V4TAxEgT3TO9AacvZoVeZC3/AD+ogM0WVv9mu+nWj91DhBgBov24VPF1FPqSDlkHKutcm3jDUGLvCOz3wvrtDwRbAcY61+dQNnlGbhrEiB5umFHxPrz3lDKxsokMYnwTe0Be96SHlr7413CqwThFnyCkvcInL+BDwqnIVRK0/sYXosbr6P82sPGHDywp7XnFl895Q2lcALQNKgkpCzazmzygtMVfmOjwrm6k27MB1aYGY04FG+Wb5Odw89sToc8wiodde26d3AnppBXiAAAAAA); width:200px; height:140px; background-size:cover;"></div><h3>Extract property</h3><div>To extract any single property from the <code class="language-">responsible-loader</code> processing result, use the <code class="language-">prop=PROP_NAME</code> query parameter.<br>
Supported properties: <code class="language-">srcSet</code> <code class="language-">src</code> <code class="language-">width</code> <code class="language-">height</code> and <code class="language-">placeholder</code>.<br>
For example:
</div><pre class="language-"><code>p srcSet<span class="token operator">:</span> #<span class="token punctuation">{</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./image.jpg?prop=srcSet&amp;format=webp&amp;sizes[]=100,sizes[]=200,sizes[]=300"</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
p src webp<span class="token operator">:</span> #<span class="token punctuation">{</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./image.jpg?prop=src&amp;format=webp&amp;size=200"</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
p placeholder<span class="token operator">:</span> #<span class="token punctuation">{</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./image.jpg?prop=placeholder&amp;emitFile=false&amp;placeholder=true&amp;placeholderSize=50"</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
p width <span class="token keyword">of</span> original image size<span class="token operator">:</span> #<span class="token punctuation">{</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./image.jpg?prop=width&amp;emitFile=false"</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
p height <span class="token keyword">of</span> resised image<span class="token operator">:</span> #<span class="token punctuation">{</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./image.jpg?prop=height&amp;size=200"</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
</code></pre><h3>Notes</h3><ul><li><div>To resolve a source image file in the <code class="language-">src</code> attribute of the <code class="language-">img</code> tag is not need to use the <code class="language-">require()</code> function:</div><pre class="language-"><code><span class="token tag">img<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">src</span><span class="token punctuation">=</span><span class="token attr-value"><span class="token string">'./image.jpg?size=200'</span></span><span class="token punctuation">)</span></span></span>
</code></pre></li><li><div>Use the <code class="language-">require()</code> function only to resolve a source file in a Pug code or in text:</div><pre class="language-"><code><span class="token punctuation">-</span><span class="token code"> <span class="token keyword">const</span> imageSrc <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./image.jpg?size=640'</span><span class="token punctuation">)</span></span>
<span class="token tag">img<span class="token attributes"><span class="token punctuation">(</span><span class="token attr-name">src</span><span class="token punctuation">=</span><span class="token attr-value">imageSrc</span><span class="token punctuation">)</span></span></span></code></pre></li></ul></section></main><div class="footer-container"><div>Copyleft <span class="copyleft"></span> 2024 <a href="https://github.com/webdiscus">@webdiscus</a>.
Powered by <a href="https://github.com/webdiscus/pug-plugin">Pug Plugin</a>
and <a href="https://github.com/dazuaz/responsive-loader">Responsive Loader</a>.
</div></div><script src="assets/js/main.aca5f5c0.js"></script></body></html>